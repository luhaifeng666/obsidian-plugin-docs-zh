import{_ as s,o as n,c as a,V as l}from"./chunks/framework.5378c159.js";const p="/obsidian-plugin-docs-zh/images/img/decorations.svg",b=JSON.parse('{"title":"è£…é¥°","description":"","frontmatter":{"title":"è£…é¥°"},"headers":[],"relativePath":"zh2.0/editor/extensions/decorations.md","filePath":"zh2.0/editor/extensions/decorations.md","lastUpdated":1685691620000}'),o={name:"zh2.0/editor/extensions/decorations.md"},e=l('<h1 id="è£…é¥°" tabindex="-1">è£…é¥° <a class="header-anchor" href="#è£…é¥°" aria-label="Permalink to &quot;è£…é¥°&quot;">â€‹</a></h1><p>è£…é¥°è®©æ‚¨æ§åˆ¶åœ¨<a href="./">ç¼–è¾‘å™¨æ‰©å±•ä¸­</a>å¦‚ä½•ç»˜åˆ¶æˆ–è€…å±•ç¤ºå†…å®¹ã€‚å¦‚æœæ‚¨æ‰“ç®—é€šè¿‡åœ¨ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼Œæ›¿æ¢æˆ–è€…æ ·å¼åŒ–æ ‡ç­¾æ¥æ›´æ”¹å¤–è§‚ï¼Œæ‚¨å¾ˆå¯èƒ½éœ€è¦ä½¿ç”¨è£…é¥°ã€‚</p><p>é˜…è¯»å®Œæ­¤æŒ‡å—åï¼Œæ‚¨å°†ä¼šï¼š</p><ul><li>ç†è§£å¦‚ä½•ä½¿ç”¨è£…é¥°å»æ”¹å˜ç¼–è¾‘å™¨çš„å¤–è§‚ã€‚</li><li>ç†è§£ä½¿ç”¨çŠ¶æ€å­—æ®µä»¥åŠè§†å›¾æ’ä»¶æä¾›è£…é¥°ä¹‹é—´çš„åŒºåˆ«ã€‚</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>æœ¬é¡µæ—¨åœ¨æç‚¼ CodeMirror 6 å®˜æ–¹ä¸º Obsidian æ’ä»¶å¼€å‘è€…ä»¬æ‰€æä¾›æ–‡æ¡£çš„ç²¾åéƒ¨åˆ†ã€‚æƒ³è¦è·å–æ›´å¤šå…³äºçŠ¶æ€å­—æ®µçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥é˜… <a href="https://codemirror.net/docs/guide/#decorating-the-document" target="_blank" rel="noreferrer">Decorating the Document</a> æ­¤æ–‡æ¡£ã€‚</p></div><h2 id="å…ˆå†³æ¡ä»¶" tabindex="-1">å…ˆå†³æ¡ä»¶ <a class="header-anchor" href="#å…ˆå†³æ¡ä»¶" aria-label="Permalink to &quot;å…ˆå†³æ¡ä»¶&quot;">â€‹</a></h2><ul><li>åŸºæœ¬äº†è§£ <a href="./state-fields.html">çŠ¶æ€å­—æ®µ</a>ã€‚</li><li>åŸºæœ¬äº†è§£ <a href="./view-plugins.html">è§†å›¾æ’ä»¶</a>ã€‚</li></ul><h2 id="æ¦‚è§ˆ" tabindex="-1">æ¦‚è§ˆ <a class="header-anchor" href="#æ¦‚è§ˆ" aria-label="Permalink to &quot;æ¦‚è§ˆ&quot;">â€‹</a></h2><p>ä¸ä½¿ç”¨è£…é¥°æ—¶ï¼Œæ–‡æ¡£å°†å‘ˆç°ä¸ºçº¯æ–‡æœ¬çš„å½¢å¼ã€‚ä¸€ç‚¹ä¹Ÿä¸æœ‰è¶£ã€‚ä½¿ç”¨è£…é¥°åï¼Œæ‚¨å°†æ”¹å˜æ–‡æ¡£çš„å±•ç¤ºå½¢å¼ï¼Œæ¯”å¦‚é«˜äº®æ–‡æœ¬æˆ–è€…æ·»åŠ è‡ªå®šä¹‰ HTML æ ‡ç­¾ï¼š</p><p>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»å‹çš„è£…é¥°ï¼š</p><ul><li>ä½¿ç”¨ <a href="https://codemirror.net/docs/ref/#view.Decoration%5Emark" target="_blank" rel="noreferrer">Mark decorations</a> ä¿®æ”¹ç°æœ‰å…ƒç´ çš„æ ·å¼ã€‚</li><li>ä½¿ç”¨ <a href="https://codemirror.net/docs/ref/#view.Decoration%5Ewidget" target="_blank" rel="noreferrer">Widget decorations</a> åœ¨æ–‡æ¡£ä¸­æ’å…¥æ ‡ç­¾ã€‚</li><li>ä½¿ç”¨ <a href="https://codemirror.net/docs/ref/#view.Decoration%5Ereplace" target="_blank" rel="noreferrer">Replace decorations</a> éšè—æˆ–ä½¿ç”¨å…¶ä»–æ ‡ç­¾æ›¿æ¢æ–‡æ¡£çš„éƒ¨åˆ†å†…å®¹ã€‚</li><li>ä½¿ç”¨ <a href="https://codemirror.net/docs/ref/#view.Decoration%5Eline" target="_blank" rel="noreferrer">Line decorations</a> ä»…ä¸ºçº¿æ·»åŠ æ ·å¼ã€‚</li></ul><p>è¦æƒ³ä½¿ç”¨è£…é¥°ï¼Œæ‚¨éœ€è¦åœ¨ç¼–è¾‘å™¨æ‰©å±•å†…åˆ›å»ºä»–ä»¬ï¼Œå¹¶å°†æ‰©å±•ç¨‹åº <strong>æä¾›</strong> ç»™ç¼–è¾‘å™¨ã€‚æ‚¨æœ‰ä¸¤ç§å°†è£…é¥°æä¾›ç»™ç¼–è¾‘å™¨çš„æ–¹å¼ï¼Œ<strong>ç›´æ¥</strong> ä½¿ç”¨<a href="./state-fields.html">çŠ¶æ€å­—æ®µ</a> æˆ–è€… <strong>é—´æ¥</strong> ä½¿ç”¨<a href="./view-plugins.html">è§†å›¾æ’ä»¶</a>ã€‚</p><h2 id="ä½•æ—¶ä½¿ç”¨è§†å›¾æ’ä»¶æˆ–è€…çŠ¶æ€å­—æ®µ" tabindex="-1">ä½•æ—¶ä½¿ç”¨è§†å›¾æ’ä»¶æˆ–è€…çŠ¶æ€å­—æ®µ <a class="header-anchor" href="#ä½•æ—¶ä½¿ç”¨è§†å›¾æ’ä»¶æˆ–è€…çŠ¶æ€å­—æ®µ" aria-label="Permalink to &quot;ä½•æ—¶ä½¿ç”¨è§†å›¾æ’ä»¶æˆ–è€…çŠ¶æ€å­—æ®µ&quot;">â€‹</a></h2><p>è§†å›¾æ’ä»¶ä»¥åŠçŠ¶æ€å­—æ®µéƒ½å¯ä»¥ä¸ºç¼–è¾‘å™¨æä¾›è£…é¥°ï¼Œä½†æ˜¯ä»–ä»¬ä¹‹é—´æœ‰äº›åŒºåˆ«ï¼š</p><ul><li>å¦‚æœæ‚¨å¯ä»¥æ ¹æ®è§†å›¾å†…éƒ¨çš„å†…å®¹å†³å®šè£…é¥°ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨è§†å›¾æ’ä»¶ã€‚</li><li>å¦‚æœæ‚¨éœ€è¦åœ¨è§†å›¾å¤–éƒ¨ç®¡ç†è£…é¥°ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨çŠ¶æ€å­—æ®µã€‚</li><li>å¦‚æœæ‚¨æƒ³åšå‡ºå¯èƒ½æ”¹å˜è§†å›¾å†…å®¹çš„ä¿®æ”¹ï¼Œæ¯”å¦‚æ·»åŠ åˆ†å‰²çº¿ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨çŠ¶æ€å­—æ®µã€‚</li></ul><p>å¦‚æœæ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€ç§æ–¹æ³•æ¥å®ç°æ‚¨çš„æ‰©å±•, é‚£ä¹ˆè§†å›¾æ’ä»¶å¾€å¾€èƒ½å¸¦æ¥æ›´å¥½çš„æ€§èƒ½ã€‚æ¯”å¦‚ï¼Œè¯•æƒ³ä¸‹æ‚¨æ‰“ç®—å®ç°ä¸€ä¸ªç”¨æ¥æ£€æŸ¥æ–‡æ¡£æ‹¼å†™çš„ç¼–è¾‘å™¨æ‰©å±•ã€‚</p><p>ä¸€ç§æ–¹æ³•æ˜¯å°†æ•´ä¸ªæ–‡æ¡£ä¼ é€’ç»™å¤–éƒ¨æ‹¼å†™æ£€æŸ¥å™¨ï¼Œç„¶åè¿”å›é”™è¯¯åˆ—è¡¨ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œä¸ç®¡å½“å‰è§†å£ä¸­æœ‰ä»€ä¹ˆï¼Œæ‚¨éœ€è¦å°†æ¯æ¡é”™è¯¯æ˜ å°„åˆ°è£…é¥°ï¼Œå¹¶ä½¿ç”¨çŠ¶æ€å­—æ®µæ¥ç®¡ç†è£…é¥°ã€‚</p><p>å¦ä¸€ç§æ–¹å¼æ˜¯ä»…ä»…åªæ£€æŸ¥å±•ç¤ºåœ¨è§†å£ä¸­çš„å†…å®¹ã€‚åœ¨ç”¨æˆ·æ»šåŠ¨æµè§ˆæ–‡æ¡£æ—¶ï¼Œæ”¹æ‰©å±•éœ€è¦ä¸æ–­åœ°æ‰§è¡Œæ‹¼å†™æ£€æŸ¥ï¼Œä½†æ‚¨å¯ä»¥æ‹¼å†™æ£€æŸ¥åŒ…å«æ•°ç™¾ä¸‡è¡Œæ–‡æœ¬çš„æ–‡æ¡£ã€‚</p><p><img src="'+p+`" alt="State field vs. view plugin"></p><h2 id="æä¾›è£…é¥°" tabindex="-1">æä¾›è£…é¥° <a class="header-anchor" href="#æä¾›è£…é¥°" aria-label="Permalink to &quot;æä¾›è£…é¥°&quot;">â€‹</a></h2><p>æƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨æƒ³æ„å»ºä¸€ä¸ªç¼–è¾‘å™¨æ‰©å±•ï¼Œç”¨è¡¨æƒ…ç¬¦å·æ›¿æ¢é¡¹ç›®ç¬¦å·åˆ—è¡¨é¡¹ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨è§†å›¾æ’ä»¶æˆ–çŠ¶æ€å­—æ®µæ¥å®Œæˆæ­¤æ“ä½œï¼Œä½†æœ‰ä¸€äº›åŒºåˆ«ã€‚ åœ¨æœ¬èŠ‚ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨è¿™ä¸¤ç§ç±»å‹çš„æ‰©å±•æ¥å®ç°å®ƒã€‚</p><p>ä¸¤ç§å®ç°å…±äº«ç›¸åŒçš„æ ¸å¿ƒé€»è¾‘ï¼š</p><ol><li>ä½¿ç”¨ <a href="https://codemirror.net/docs/ref/#language.syntaxTree" target="_blank" rel="noreferrer">syntaxTree</a> æŸ¥æ‰¾åˆ—è¡¨é¡¹ã€‚</li><li>å°†æ¯ä¸ªåˆ—è¡¨é¡¹çš„å‰å¯¼è¿å­—ç¬¦ <code>-</code> æ›¿æ¢ä¸ºå°éƒ¨ä»¶ã€‚</li></ol><h3 id="å°éƒ¨ä»¶" tabindex="-1">å°éƒ¨ä»¶ <a class="header-anchor" href="#å°éƒ¨ä»¶" aria-label="Permalink to &quot;å°éƒ¨ä»¶&quot;">â€‹</a></h3><p>å°éƒ¨ä»¶æ˜¯æ‚¨æ·»åŠ åˆ°ç¼–è¾‘å™¨ä¸­çš„è‡ªå®šä¹‰ HTML æ ‡ç­¾ã€‚æ‚¨å¯ä»¥åœ¨æ–‡æ¡£ä¸­çš„ç‰¹å®šä½ç½®æ’å…¥ä¸€ä¸ªå°éƒ¨ä»¶ï¼Œæˆ–è€…ç”¨ä¸€ä¸ªå°éƒ¨ä»¶æ›¿æ¢ä¸€æ®µå†…å®¹ã€‚</p><p>ä¸‹ä¾‹ä¸­å®šä¹‰äº†ä¸€ä¸ªè¿”å› <code>&lt;span&gt;ğŸ‘‰&lt;/span&gt;</code> HTML æ ‡ç­¾çš„å°éƒ¨ä»¶ã€‚æ‚¨å°†åœ¨ç¨åä½¿ç”¨åˆ°å®ƒã€‚</p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">EditorView</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">WidgetType</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@codemirror/view</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">EmojiWidget</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WidgetType</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">toDOM</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">view</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">EditorView</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HTMLElement</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">div</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">span</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">innerText</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ğŸ‘‰</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¦æƒ³ä½¿ç”¨ emoji å°éƒ¨ä»¶æ›¿æ¢æ‚¨æ–‡æ¡£ä¸­çš„ä¸€éƒ¨åˆ†å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://codemirror.net/docs/ref/#view.Decoration%5Ereplace" target="_blank" rel="noreferrer">æ›¿æ¢è£…é¥°</a>ã€‚</p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> decoration </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Decoration</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">widget</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">EmojiWidget</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="çŠ¶æ€å­—æ®µ" tabindex="-1">çŠ¶æ€å­—æ®µ <a class="header-anchor" href="#çŠ¶æ€å­—æ®µ" aria-label="Permalink to &quot;çŠ¶æ€å­—æ®µ&quot;">â€‹</a></h3><p>æä¾›æ¥è‡ªçŠ¶æ€å­—æ®µçš„è£…é¥°ï¼š</p><ol><li>ä½¿ç”¨ <code>DecorationSet</code> ç±»å‹<a href="./state-fields.html#defining-a-state-field">å®šä¹‰çŠ¶æ€å­—æ®µ</a></li><li>å°† <code>provide</code> å±æ€§æ·»åŠ åˆ°çŠ¶æ€å­—æ®µä¸­ã€‚</li></ol><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">provide</span><span style="color:#A6ACCD;">(field: StateField</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">DecorationSet</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">): Extension </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">EditorView</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">decorations</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">field</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">},</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-tU7Ul" id="tab-XzE4tSQ" checked="checked"><label for="tab-XzE4tSQ">field.ts</label></div><div class="blocks"><div class="language-ts active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">syntaxTree</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@codemirror/language</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">Extension</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">RangeSetBuilder</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">StateField</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">Transaction</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@codemirror/state</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">Decoration</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">DecorationSet</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">EditorView</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">WidgetType</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@codemirror/view</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">EmojiWidget</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">emoji</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> emojiListField </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> StateField</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">define</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">DecorationSet</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">create</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">state</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DecorationSet</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Decoration</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">none</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">update</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">oldState</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DecorationSet</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">transaction</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Transaction</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DecorationSet</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">builder</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">RangeSetBuilder</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Decoration</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">syntaxTree</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">transaction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">iterate</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      enter</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">startsWith</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">list</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// Position of the &#39;-&#39; or the &#39;*&#39;.</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">listCharFrom</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">from</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#A6ACCD;">builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">listCharFrom</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">listCharFrom</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">Decoration</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">              widget</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">EmojiWidget</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">          )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">finish</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">provide</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">field</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">StateField</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">DecorationSet</span><span style="color:#89DDFF;">&gt;):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Extension</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">EditorView</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">decorations</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">field</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div></div></div><h3 id="è§†å›¾æ’ä»¶" tabindex="-1">è§†å›¾æ’ä»¶ <a class="header-anchor" href="#è§†å›¾æ’ä»¶" aria-label="Permalink to &quot;è§†å›¾æ’ä»¶&quot;">â€‹</a></h3><p>To manage your decorations using a view plugin:</p><p>ä½¿ç”¨è§†å›¾æ’ä»¶ç®¡ç†æ‚¨çš„è£…é¥°ï¼š</p><ol><li><a href="./view-plugins.html#creating-a-view-plugin">åˆ›å»ºä¸€ä¸ªè§†å›¾æ’ä»¶</a>.</li><li>åœ¨æ‚¨çš„æ’ä»¶ä¸­æ·»åŠ  <code>DecorationSet</code> æˆå‘˜å±æ€§ã€‚</li><li>åœ¨ <code>constructor()</code> æ–¹æ³•ä¸­åˆå§‹åŒ–è£…é¥°ã€‚</li><li>åœ¨ <code>update()</code> ä¸­é‡æ–°æ„å»ºè£…é¥°ã€‚</li></ol><p>ä»¥ä¸‹ç¤ºä¾‹ä»…åœ¨åŸºç¡€æ–‡æ¡£æˆ–è§†å£æ›´æ”¹æ—¶é‡å»ºè£…é¥°ã€‚ä»¥ä¸‹ç¤ºä¾‹ä»…åœ¨åŸºç¡€æ–‡æ¡£æˆ–è§†å£æ›´æ”¹æ—¶é‡å»ºè£…é¥°ã€‚</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-4joww" id="tab-0VEDYyt" checked="checked"><label for="tab-0VEDYyt">plugin.ts</label></div><div class="blocks"><div class="language-ts active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">syntaxTree</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@codemirror/language</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">RangeSetBuilder</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@codemirror/state</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">Decoration</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">DecorationSet</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">EditorView</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">PluginSpec</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">PluginValue</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">ViewPlugin</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">ViewUpdate</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">WidgetType</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@codemirror/view</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">EmojiWidget</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">emoji</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">EmojiListPlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">implements</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginValue</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">decorations</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DecorationSet</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">view</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">EditorView</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">decorations</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">buildDecorations</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">view</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">update</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">update</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ViewUpdate</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">update</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">docChanged</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">update</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">viewportChanged</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">decorations</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">buildDecorations</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">update</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">view</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">destroy</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">buildDecorations</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">view</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">EditorView</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DecorationSet</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">builder</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">RangeSetBuilder</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Decoration</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">from</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">to</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">view</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">visibleRanges</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">syntaxTree</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">view</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">iterate</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">from</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">to</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        enter</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">node</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">startsWith</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">list</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// Position of the &#39;-&#39; or the &#39;*&#39;.</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">listCharFrom</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">from</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#A6ACCD;">listCharFrom</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#A6ACCD;">listCharFrom</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#A6ACCD;">Decoration</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">                widget</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">EmojiWidget</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">            )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">builder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">finish</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> pluginSpec</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginSpec</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">EmojiListPlugin</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">decorations</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">EmojiListPlugin</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">decorations</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> emojiListPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ViewPlugin</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fromClass</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  EmojiListPlugin</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  pluginSpec</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div></div></div><p><code>buildDecorations()</code> æ˜¯ä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼Œå®ƒåŸºäºç¼–è¾‘å™¨è§†å›¾æ„å»ºä¸€æ•´å¥—è£…é¥°ã€‚</p><p>æ³¨æ„ä¼ å…¥ <code>ViewPlugin.fromClass()</code> çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚<code>PluginSpec</code> ä¸­çš„ <code>decorations</code> å±æ€§æŒ‡å®šè§†å›¾æ’ä»¶å¦‚ä½•å‘ç¼–è¾‘å™¨æä¾›è£…é¥°ã€‚</p><p>ç”±äºè§†å›¾æ’ä»¶çŸ¥é“ä»€ä¹ˆå¯¹ç”¨æˆ·å¯è§ï¼Œå› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨ <code>view.visibleRanges</code> æ¥é™åˆ¶è¦è®¿é—®çš„è¯­æ³•æ ‘çš„å“ªäº›éƒ¨åˆ†ã€‚</p>`,43),r=[e];function t(c,F,D,y,i,C){return n(),a("div",null,r)}const u=s(o,[["render",t]]);export{b as __pageData,u as default};
